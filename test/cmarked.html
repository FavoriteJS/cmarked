<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>cmarked</title>
	<link rel="stylesheet" href="">
	<style>
		* {
			box-sizing: border-box;
		}
		#inter {
			display: flex;
			justify-content: center;
		}
		#inter section {
			width: 0px;
			margin: 5px;
		}
		#inter #input {
			flex-grow: 1;
		}
		#inter #compiled {
			flex-grow: 1;
			border: 1px dashed skyblue;
		}
		#inter #input textarea {
			width: 100%;
			height: 80vh;
		}
		#inter #output {
			flex-grow: 1;
			border: 1px dashed skyblue;
		}
		#regexp-test {
			display: flex;
		}
		#regexp-test section {
			width: 0px;
			flex-grow: 1;
			margin: 5px;
		}
		#regexp-test section textarea {
			width: 100%;
		}
		#regexp-test section:nth-child(3) {
			border: 1px dashed skyblue;
		}
		#output-iframe {
			width: 100%;
			height: 80vh;
		}
	</style>
</head>
<body>
	<h1 style="text-align: center">markdown编译器cmarked</h1>
	<section id="inter">
		<button id="compile">编译</button>
		<section id="input">
			<textarea name="source" id="source" cols="30" rows="10"></textarea>
		</section>
		<section id="output">
			<iframe id="output-iframe">
				
			</iframe>
		</section>
	</section>

	<script src="http://localhost:3000/lib/cmarked.js"></script>
	<script src="//cdn.bootcss.com/socket.io/1.4.5/socket.io.js"></script>
	<script>
	  var socket = io.connect('http://localhost:3000');
	    socket.on('news', function (data) {
	    	console.log(data)
	     window.location.reload()
	    });
	</script>

	<script>
		// markdown编译
		document.querySelector('#compile').addEventListener('click', () => {
			let source = document.querySelector('#source').value

			let compiled = '<head><link rel="stylesheet" href="http://localhost:3000/test/github2.css"></head><body>'
			compiled += cmarked(source)
			compiled += '</body>'

			let outputIframe = document.getElementById('output-iframe')

			let outputIframeDoc = outputIframe.contentWindow.document
			outputIframeDoc.designMode = 'on'
			outputIframeDoc.open()
			outputIframeDoc.write(compiled)
			outputIframeDoc.close()
			outputIframeDoc.designMode = 'off'
			outputIframeDoc.location.reload()
		})
	</script>
	<script>
		document.onkeydown = (e) => {
			if(e.ctrlKey && e.key === 'l') {
				document.querySelector('#compile').click()
			}
		}
	</script>
</body>
</html>